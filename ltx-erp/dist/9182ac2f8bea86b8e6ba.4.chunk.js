webpackJsonp([4],{244:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s,d,u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},h=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0,n(493);var c=n(3),m=a(c),f=n(11),p=n(6),g=a(p),b=n(10),v=a(b),y=n(59),_=n(29),E=n(149),C=a(E),k=n(60),B=a(k),w=n(151),O=a(w),P=n(75),A=n(14),S=a(A),N=n(58),x=(s=(0,f.connect)(function(e){return{city:e.get("city"),recommender:e.get("personal"),property:e.getIn(["property","addDetail"]),isAdding:e.getIn(["property","isAdding"]),buildings:e.getIn(["property","buildings"]),isShowAddResult:e.getIn(["property","isShowAddResult"])}}),(0,v["default"])(d=s(d=function(e){function t(e){i(this,t);var n=o(this,Object.getPrototypeOf(t).call(this,e));return n._handleChange=n._handleChange.bind(n),n._handleCityChange=n._handleCityChange.bind(n),n._handleDistrictChange=n._handleDistrictChange.bind(n),n._handleCommChange=n._handleCommChange.bind(n),n._handleAddProperty=n._handleAddProperty.bind(n),n._handlebBuildingChange=n._handlebBuildingChange.bind(n),n._back2Buildings=n._back2Buildings.bind(n),n._goOnBuilding=n._goOnBuilding.bind(n),n._handleNoValidate=n._handleNoValidate.bind(n),n.state={blockname:{require:!0,value:"",isError:!1},unitnum:{require:!0,value:"",isError:!1},price:{require:!0,value:"",isError:!1},area:{require:!0,value:"",isError:!1},ownerTel:{require:!0,value:"",isError:!1}},n}return l(t,e),h(t,[{key:"componentDidMount",value:function(){var e=this.props.dispatch;e((0,y.fetchCitysIfNeed)()),e((0,_.fetchPersonalIfNeed)())}},{key:"render",value:function(){var e=this,t=this.props.city.get("citys"),n=this.props.city.get("districts"),a=this.props.city.getIn(["currentDistrict","comms"]),r=this.props.buildings,i=this.props,o=i.recommender,l=i.property,s=i.isAdding,d=i.isShowAddResult,u=o.get("isPerfectInfo");return m["default"].createElement("div",{className:"add-property"},m["default"].createElement("main",null,m["default"].createElement(C["default"],{label:"城市",options:t,onChange:this._handleCityChange}),m["default"].createElement(C["default"],{label:"区域",options:n,onChange:this._handleDistrictChange}),m["default"].createElement(C["default"],{label:"商圈",options:a,onChange:this._handleCommChange}),m["default"].createElement(C["default"],{label:"楼盘",name:"buildingId",placeholder:a?"请选择":"请先选择城市、区域和商圈",options:r,onChange:this._handlebBuildingChange}),m["default"].createElement(B["default"],{onChange:this._handleChange.bind(this),ref:"blockname",value:this.state.blockname.value,onBlur:this._handleBlur.bind(this),name:"blockname",placeholder:"请输入栋座，如A",isError:this.state.blockname.isError,onFocus:this._handleFocus.bind(this),label:"栋座"}),m["default"].createElement(B["default"],{onChange:this._handleChange.bind(this),ref:"unitnum",value:this.state.unitnum.value,onBlur:this._handleBlur.bind(this),name:"unitnum",placeholder:"请输入单元号，如1001",isError:this.state.unitnum.isError,label:"单元号",onFocus:this._handleFocus.bind(this)}),m["default"].createElement(C["default"],{value:l.get("status"),name:"status",label:"性质",options:g["default"].fromJS([{id:0,name:"可租"},{id:1,name:"可售"},{id:2,name:"租售"}]),onChange:this._handleNoValidate}),m["default"].createElement(B["default"],{className:"md",onChange:this._handleChange.bind(this),ref:"price",value:this.state.price.value,onBlur:this._handleBlur.bind(this),isError:this.state.price.isError,onFocus:this._handleFocus.bind(this),name:"price",label:"价格"}),m["default"].createElement(C["default"],{className:"sm",value:l.get("priceunit"),name:"priceunit",options:g["default"].fromJS([{id:1,name:"元/平·天"},{id:2,name:"元/平·月"},{id:3,name:"元/月"}]),onChange:this._handleNoValidate}),m["default"].createElement(B["default"],{onChange:this._handleChange.bind(this),ref:"area",value:this.state.area.value,isError:this.state.area.isError,onBlur:this._handleBlur.bind(this),onFocus:this._handleFocus.bind(this),name:"area",label:"面积"}),m["default"].createElement(B["default"],{onChange:this._handleChange.bind(this),value:this.state.ownerTel.value,isError:this.state.ownerTel.isError,onBlur:this._handleBlur.bind(this),onFocus:this._handleFocus.bind(this),name:"ownerTel",label:"业主电话"}),m["default"].createElement(B["default"],{value:l.get("rpremark"),onBlur:this._handleNoValidate.bind(this),name:"rpremark",label:"备注"})),m["default"].createElement(O["default"],{onTap:function(t){return e.props.history.pushState(null,"/personalUpdate")},recommender:o}),m["default"].createElement("footer",null,m["default"].createElement(S["default"],{style:{backgroundColor:s?"#d63636":"#ef4f4f"},component:"div",onTap:this._handleAddProperty},s?"提交中...":"确认")),m["default"].createElement("div",{className:"bind-modal",style:{display:d&&u?"block":"none"}},m["default"].createElement("main",null,m["default"].createElement("img",{src:N.successImg}),m["default"].createElement("h2",null,"推荐成功"),m["default"].createElement("span",{style:{lineHeight:"0.625rem"}},"继续推荐该楼盘的房源？"),m["default"].createElement("footer",null,m["default"].createElement(S["default"],{className:"cancel",onTap:this._back2Buildings},"返回列表"),m["default"].createElement(S["default"],{className:"save",onTap:this._goOnBuilding},"继续推荐")))))}},{key:"_handleNoValidate",value:function(e){console.log(e.target.name);var t=r({},e.target.name,e.target.value);this.props.dispatch((0,P.refreshProperty)(t))}},{key:"_handleFocus",value:function(e){this.setState(r({},e.target.name,u({},this.state[e.target.name],{isError:!1})))}},{key:"_handleBlur",value:function(e){if(""==!e.target.value){var t=r({},e.target.name,e.target.value);this.props.dispatch((0,P.refreshProperty)(t))}else this.setState(r({},e.target.name,u({},this.state[e.target.name],{isError:!0})))}},{key:"_handleChange",value:function(e){""==e.target.value?this.setState(r({},e.target.name,u({},this.state[e.target.name],{value:"",isError:!0}))):this.setState(r({},e.target.name,u({},this.state[e.target.name],{value:e.target.value})))}},{key:"_handleCityChange",value:function(e){var t=e.target.value;this.props.dispatch((0,y.fetchDistrictsAndComms)(t))}},{key:"_handleDistrictChange",value:function(e){var t=this.props.city.get("districts").find(function(t){return t.get("id")==e.target.value});this.props.dispatch((0,y.setCurrentDsitrict)(t))}},{key:"_handleCommChange",value:function(e){this.props.dispatch((0,P.fetchBuildings)(e.target.value))}},{key:"_handlebBuildingChange",value:function(e){this._handleBlur(e)}},{key:"_handleAddProperty",value:function(){if(!this.props.isAdding){for(var e in this.state)this._handleBlur({target:{name:e,value:this.state[e].value}});setTimeout(function(){var e=this.state,t=e.blockname,n=e.unitnum,a=e.price,r=e.area;t.isError||n.isError||a.isError||r.isError||(this.props.dispatch((0,P.addProperty)()),this.props.recommender.get("isPerfectInfo")||this.props.history.pushState(null,"/personalUpdate?from=property"))}.bind(this))}}},{key:"_back2Buildings",value:function(){this.props.dispatch((0,P.isShowAddResult)(!1)),this.props.history.pushState(null,"/propertys")}},{key:"_goOnBuilding",value:function(){this.props.dispatch((0,P.isShowAddResult)(!1))}},{key:"componentWillUnmount",value:function(){this.props.dispatch((0,P.isShowAddResult)(!1))}}]),t}(c.Component))||d)||d);t["default"]=x},118:function(e,t,n){t=e.exports=n(17)(),t.push([e.id,".add-customer>main{padding:.3125rem}.add-customer>footer{height:1.875rem;padding:.3125rem;border-top:.03125rem solid #ccc}.add-customer>footer>div{height:1.25rem;border-radius:.125rem;background-color:#ef4f4f;text-align:center;color:#fff;line-height:1.25rem;font-size:.5rem}.bind-modal{z-index:1000;position:absolute;left:0;right:0;top:0;bottom:0;background-color:rgba(0,0,0,.5);padding:.46875rem .78125rem 0 .46875rem}.add-property>main{padding:.3125rem}.add-property>footer{height:1.875rem;padding:.3125rem;border-top:.03125rem solid #ccc}.add-property>footer>div{height:1.25rem;border-radius:.125rem;background-color:#ef4f4f;text-align:center;color:#fff;line-height:1.25rem;font-size:.5rem}.bind-modal{position:absolute;left:0;right:0;top:0;bottom:0;background-color:rgba(0,0,0,.5);padding:.46875rem .78125rem 0 .46875rem}.bind-modal>main{vertical-align:top;text-align:center;font-size:0;line-height:1.40625rem;background-color:#fff;padding:.625rem .3125rem .3125rem}.bind-modal>main>div{line-height:.625rem;font-size:.40625rem}.bind-modal>main>label{font-size:.40625rem;display:inline-block;width:2.1875rem}.bind-modal>main>input{padding-left:.3125rem;font-size:.40625rem;display:inline-block;width:5.625rem;height:1.09375rem;border-radius:8px;border:2px solid #ccc}.bind-modal>main>span{font-size:.40625rem}.bind-modal>main>img{display:block;margin:auto}.bind-modal>main>.get{margin-left:2.1875rem;display:inline-block;height:1.09375rem;line-height:1.09375rem;width:1.875rem;background-color:#ef4f4f;margin-top:.15625rem;border-radius:8px;color:#fff;text-align:center;margin-right:.15625rem}.bind-modal>main>footer{text-align:center;margin-top:.9375rem}.bind-modal>main>footer .cancel{color:#ef4f4f;border:.03125rem solid #ef4f4f;border-radius:.125rem}.bind-modal>main>footer .cancel,.bind-modal>main>footer>.save{text-align:center;display:inline-block;width:3.75rem;height:1.25rem;line-height:1.25rem;font-size:.5rem;background-color:#fff}.bind-modal>main>footer>.save{color:#ef4f4f;border:.03125rem solid #ef4f4f;border-radius:.125rem;color:#fff;background-color:#ef4f4f;margin-left:.3125rem;border:0}",""])},493:function(e,t,n){var a=n(118);"string"==typeof a&&(a=[[e.id,a,""]]);var r=n(18)(a,{});a.locals&&(e.exports=a.locals),a.locals||e.hot.accept(118,function(){var t=n(118);"string"==typeof t&&(t=[[e.id,t,""]]),r(t)}),e.hot.dispose(function(){r()})}});